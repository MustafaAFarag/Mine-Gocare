<div *ngIf="!showOrderDetails" class="rounded-lg bg-white p-6 shadow-sm">
  <h2 class="mb-6 text-xl font-bold text-gray-800">My Orders</h2>

  <!-- Orders Table -->
  <div class="overflow-x-auto">
    <table class="w-full">
      <!-- Table Header -->
      <thead>
        <tr class="border-b">
          <th class="px-4 py-4 text-left font-medium text-gray-700">
            Order Number
          </th>
          <th class="px-4 py-4 text-left font-medium text-gray-700">Date</th>
          <th class="px-4 py-4 text-left font-medium text-gray-700">Amount</th>
          <th class="px-4 py-4 text-center font-medium text-gray-700">
            Status
          </th>
          <th class="px-4 py-4 text-left font-medium text-gray-700">
            Payment Method
          </th>
          <th class="px-4 py-4 text-left font-medium text-gray-700">Option</th>
        </tr>
      </thead>

      <!-- Table Body -->
      <tbody>
        <tr
          *ngFor="let order of currentPageItems"
          class="border-b hover:bg-gray-50"
        >
          <td class="px-4 py-4 font-medium text-gray-700">
            {{ order.orderNumber }}
          </td>
          <td class="px-4 py-4 text-gray-700">
            {{ order.creationDate | date: "dd MMM yyyy hh:mm a" }}
          </td>
          <td class="px-4 py-4 text-gray-700">
            {{ order.totalPayment }} {{ order.currency.name.en }}
          </td>
          <td class="px-4 py-4 text-center">
            <span
              class="rounded-md px-3 py-1 text-sm font-medium"
              [ngClass]="{
                'bg-yellow-100 text-yellow-600':
                  order.status === 1 && !order.isCanceled,
                'bg-green-100 text-green-600':
                  order.status === 2 && !order.isCanceled,
                'bg-blue-100 text-blue-600':
                  order.status === 3 && !order.isCanceled,
                'bg-red-100 text-red-600':
                  order.status === 4 || order.isCanceled,
              }"
            >
              {{
                order.isCanceled
                  ? "Canceled"
                  : order.status === 1
                    ? "In Progress"
                    : order.status === 2
                      ? "Completed"
                      : order.status === 3
                        ? "Shipped"
                        : order.status === 4
                          ? "Rejected"
                          : "Unknown"
              }}
            </span>
          </td>
          <td class="py-4 text-center text-gray-700">
            {{
              order.paymentMethod === 0
                ? "Cash on Delivery"
                : order.paymentMethod === 1
                  ? "Credit Card"
                  : "Unknown"
            }}
          </td>

          <td class="px-4 py-4 text-center">
            <div class="flex justify-center space-x-3">
              <button
                (click)="viewOrderDetails(order.id)"
                class="text-gray-500 hover:text-gray-700"
                aria-label="View order details"
              >
                <i class="ri-eye-line"></i>
              </button>
              <button
                *ngIf="order.status === 1 && !order.isCanceled"
                (click)="cancelOrder(order.id)"
                class="text-red-500 hover:text-red-700"
                aria-label="Cancel order"
              >
                <i class="ri-close-circle-line"></i>
              </button>
            </div>
          </td>
        </tr>

        <!-- Empty State (shown when no orders) -->
        <tr *ngIf="orders.length === 0">
          <td colspan="6" class="py-8 text-center text-gray-500">
            <div class="flex flex-col items-center">
              <i class="ri-shopping-bag-line mb-2 text-4xl text-gray-400"></i>
              <p>You haven't placed any orders yet.</p>
              <a href="#" class="mt-2 text-hover-color hover:text-red-800"
                >Start Shopping</a
              >
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination Controls -->
  <div
    *ngIf="totalPages > 1"
    class="mt-6 flex items-center justify-center space-x-2"
  >
    <button
      (click)="changePage(currentPage - 1)"
      [disabled]="currentPage === 1"
      class="rounded-md p-2 text-gray-600 hover:bg-gray-100 disabled:opacity-50"
      aria-label="Previous page"
    >
      <i class="ri-arrow-left-s-line"></i>
    </button>

    <div class="flex space-x-1">
      <button
        *ngFor="let page of [].constructor(totalPages); let i = index"
        (click)="changePage(i + 1)"
        class="rounded-md px-3 py-1 text-sm font-medium"
        [ngClass]="{
          'bg-hover-color text-white': currentPage === i + 1,
          'text-gray-700 hover:bg-gray-100': currentPage !== i + 1,
        }"
      >
        {{ i + 1 }}
      </button>
    </div>

    <button
      (click)="changePage(currentPage + 1)"
      [disabled]="currentPage === totalPages"
      class="rounded-md p-2 text-gray-600 hover:bg-gray-100 disabled:opacity-50"
      aria-label="Next page"
    >
      <i class="ri-arrow-right-s-line"></i>
    </button>
  </div>
</div>

<app-order-details
  *ngIf="showOrderDetails"
  [orderId]="selectedOrderId"
  [orderDetails]="orderDetails"
  (backClicked)="hideOrderDetails()"
></app-order-details>
