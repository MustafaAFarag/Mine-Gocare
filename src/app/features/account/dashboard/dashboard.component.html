<!-- Main Content -->
<div class="w-full">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex h-64 items-center justify-center">
    <app-loading></app-loading>
  </div>

  <!-- Content when loaded -->
  <div *ngIf="!isLoading">
    <!-- Welcome Section -->
    <div class="mb-6 rounded-lg bg-white p-6 shadow-sm">
      <h2 class="mb-2 text-2xl font-bold text-gray-800">
        {{ "dashboard-account.hello" | translate: { name: getFullName() } }}
      </h2>
      <p class="mb-4 text-gray-600">
        {{ "dashboard-account.welcomeText" | translate }}
      </p>

      <!-- Stats Cards -->
      <div class="mt-6 grid grid-cols-1 gap-4 md:grid-cols-3">
        <!-- Balance Card -->
        <div class="border-l-4 border-hover-color py-2 pl-4">
          <div class="flex items-center gap-4">
            <div class="text-hover-color">
              <i class="ri-wallet-3-line text-3xl"></i>
            </div>
            <div>
              <h3 class="text-xl font-bold text-hover-color">
                <ng-container *ngIf="!isLoadingWallet && wallet">
                  <span
                    *ngIf="
                      wallet.walletAmount > 0 &&
                      wallet.currency?.name?.[currentLang]
                    "
                    >{{ wallet.currency.name[currentLang] }}</span
                  >
                  {{ (wallet.walletAmount || 0).toFixed(2) }}
                </ng-container>
                <ng-container *ngIf="!isLoadingWallet && !wallet">
                  0.00
                </ng-container>
                <ng-container *ngIf="isLoadingWallet">
                  <div class="h-6 w-24 animate-pulse rounded bg-gray-200"></div>
                </ng-container>
              </h3>
              <p class="text-gray-500">
                {{ "dashboard-account.balance" | translate }}
              </p>
            </div>
          </div>
        </div>

        <!-- Orders Card -->
        <div class="border-l-4 border-hover-color py-2 pl-4">
          <div class="flex items-center gap-4">
            <div class="text-hover-color">
              <i class="ri-shopping-bag-line text-3xl"></i>
            </div>
            <div>
              <h3 class="text-xl font-bold text-hover-color">
                <ng-container *ngIf="!isLoadingOrders">
                  {{ ordersCount !== undefined ? ordersCount : 0 }}
                </ng-container>
                <ng-container *ngIf="isLoadingOrders">
                  <div class="h-6 w-12 animate-pulse rounded bg-gray-200"></div>
                </ng-container>
              </h3>
              <p class="text-gray-500">
                {{ "dashboard-account.totalOrders" | translate }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Account Information -->
    <div class="mb-6 rounded-lg bg-white p-6 shadow-sm">
      <h3 class="mb-4 text-xl font-bold text-gray-800">
        {{ "dashboard-account.accountInfo" | translate }}
      </h3>
      <ul class="ml-2 list-inside list-disc space-y-2 text-gray-600">
        <li class="flex items-center justify-between">
          <span
            ><span class="font-medium text-hover-color"
              >{{ "dashboard-account.fullName" | translate }}:</span
            >
            {{ getFullName() }}</span
          >
          <button
            (click)="updateFullName()"
            id="dashboard-account-edit-full-name-button"
            class="rounded bg-hover-color px-3 py-1 text-sm text-white hover:bg-red-800"
          >
            {{ "dashboard-account.edit" | translate }}
          </button>
        </li>
        <li class="flex items-center justify-between">
          <span>
            <span class="font-medium text-hover-color"
              >{{ "dashboard-account.gender" | translate }}:</span
            >
            {{
              user.gender === 0
                ? ("dashboard-account.men" | translate)
                : ("dashboard-account.women" | translate)
            }}
          </span>
          <button
            (click)="updateGender()"
            id="dashboard-account-edit-gender-button"
            class="rounded bg-hover-color px-3 py-1 text-sm text-white hover:bg-red-800"
          >
            {{ "dashboard-account.edit" | translate }}
          </button>
        </li>
        <li class="flex items-center justify-between">
          <span>
            <span class="font-medium text-hover-color"
              >{{ "dashboard-account.phone" | translate }}:</span
            >
            {{
              user.mobileNumber
                ? "+" + user.mobileNumber
                : ("dashboard-account.notProvided" | translate)
            }}
          </span>
          <button
            (click)="updatePhone()"
            id="dashboard-account-edit-phone-button"
            class="rounded bg-hover-color px-3 py-1 text-sm text-white hover:bg-red-800"
          >
            {{
              user.mobileNumber
                ? ("dashboard-account.edit" | translate)
                : ("dashboard-account.addNew" | translate)
            }}
          </button>
        </li>
        <li class="flex items-center justify-between">
          <span class="mr-4 min-w-0 flex-1">
            <span class="font-medium text-hover-color"
              >{{ "dashboard-account.email" | translate }}:</span
            >
            <span
              class="block truncate text-gray-500"
              [title]="user.emailAddress"
            >
              {{
                user.emailAddress ||
                  ("dashboard-account.notProvided" | translate)
              }}
            </span>
          </span>
          <button
            (click)="updateEmail()"
            id="dashboard-account-edit-email-button"
            class="flex-shrink-0 whitespace-nowrap rounded bg-hover-color px-3 py-1 text-sm text-white hover:bg-red-800"
          >
            {{
              user.emailAddress
                ? ("dashboard-account.edit" | translate)
                : ("dashboard-account.addNew" | translate)
            }}
          </button>
        </li>
      </ul>
    </div>

    <!-- Login Details -->
    <div class="rounded-lg bg-white p-6 shadow-sm">
      <h3 class="mb-4 text-xl font-bold text-gray-800">
        {{ "dashboard-account.loginDetails" | translate }}
      </h3>
      <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
        <div class="flex items-center justify-between">
          <p class="mr-4 min-w-0 flex-1 text-gray-600">
            <span class="font-medium text-hover-color"
              >{{ "dashboard-account.email" | translate }}:</span
            >
            <span
              class="block truncate text-gray-500"
              [title]="user.emailAddress"
            >
              {{
                user.emailAddress ||
                  ("dashboard-account.notProvided" | translate)
              }}
            </span>
          </p>
          <button
            (click)="updateEmail()"
            id="dashboard-account-edit-email-button"
            class="flex-shrink-0 whitespace-nowrap rounded bg-hover-color px-3 py-1 text-sm text-white hover:bg-red-800"
          >
            {{ "dashboard-account.edit" | translate }}
          </button>
        </div>
        <div class="flex items-center justify-between">
          <p class="text-gray-600">
            {{ "dashboard-account.password" | translate }}: ••••••
          </p>
          <button
            (click)="updatePassword()"
            id="dashboard-account-edit-password-button"
            class="rounded bg-hover-color px-3 py-1 text-sm text-white hover:bg-red-800"
          >
            {{ "dashboard-account.edit" | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<p-toast position="top-left" styleClass="black-text-toast"></p-toast>
