<p-dialog
  [(visible)]="visible"
  [modal]="true"
  [style]="{ width: '90vw', maxWidth: '500px' }"
  [draggable]="false"
  [resizable]="false"
  (onHide)="onClose()"
  [baseZIndex]="10000"
  [showHeader]="false"
  [transitionOptions]="'300ms cubic-bezier(0.4, 0, 0.2, 1)'"
  styleClass="auth-modal-anim"
  [contentStyle]="{ padding: '0', background: 'white' }"
  [dismissableMask]="true"
  [closable]="true"
>
  <div class="rounded-lg bg-white p-6 text-black">
    <button
      (click)="onClose()"
      class="absolute right-5 top-5 rounded-full bg-gray-200 p-1 text-xl text-hover-color hover:bg-gray-300"
    >
      <i class="ri-close-line"></i>
    </button>

    <div class="flex flex-col items-center gap-4">
      <h2 class="text-center text-2xl font-semibold">
        {{ "points.redeem.title" | translate }}
      </h2>
      <p class="text-center text-sm text-gray-500">
        {{ "points.redeem.subtitle" | translate }}
      </p>
    </div>

    <div class="mt-6 flex flex-col gap-4">
      <div class="flex items-center justify-between rounded-md bg-gray-50 p-4">
        <div>
          <p class="text-sm text-gray-500">
            {{ "points.redeem.availablePoints" | translate }}
          </p>
          <p class="text-lg font-semibold">
            {{ availablePoints }} {{ "points.points" | translate }}
          </p>
        </div>
        <div class="rounded-md bg-hover-color p-2">
          <i class="ri-coin-line text-xl text-white"></i>
        </div>
      </div>

      <div class="flex items-center justify-between rounded-md bg-gray-50 p-4">
        <div>
          <p class="text-sm text-gray-500">
            {{ "points.redeem.exchangeRate" | translate }}
          </p>
          <p class="text-lg font-semibold">
            {{ "common.currency" | translate }} {{ exchangeRate.toFixed(2) }}
          </p>
        </div>
        <div class="rounded-md bg-hover-color p-2">
          <i class="ri-exchange-dollar-line text-xl text-white"></i>
        </div>
      </div>

      <div class="mt-2">
        <label class="text-sm">{{ "points.redeem.amount" | translate }}</label>
        <input
          type="text"
          [value]="redeemAmount"
          (input)="onInputChange($event)"
          [max]="availablePoints"
          [min]="0"
          class="mt-1 w-full border border-gray-300 bg-white p-2 text-sm [appearance:textfield] focus:outline-none focus:ring-2 focus:ring-blue-500 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none"
          [placeholder]="'points.redeem.enterAmount' | translate"
        />
        <div *ngIf="hasError" class="mt-1 text-sm text-red-500">
          {{ "points.redeem.error.exceedsAvailable" | translate }}
        </div>
      </div>

      <div
        *ngIf="redeemAmount > 0 && !hasError"
        class="rounded-md bg-gray-50 p-4"
      >
        <p class="text-sm text-gray-500">
          {{ "points.redeem.youWillReceive" | translate }}
        </p>
        <p class="text-lg font-semibold">
          {{ "common.currency" | translate }}
          {{ getEquivalentAmount().toFixed(2) }}
        </p>
      </div>

      <button
        (click)="onRedeem()"
        [disabled]="isRedeeming || redeemAmount <= 0 || hasError"
        class="w-full border border-gray-300 bg-hover-color p-2 text-sm font-bold uppercase text-white focus:outline-none focus:ring-2 disabled:cursor-not-allowed disabled:opacity-50"
      >
        {{
          isRedeeming
            ? ("points.redeem.redeeming" | translate)
            : ("points.redeem.redeem" | translate)
        }}
      </button>
    </div>
  </div>
</p-dialog>
