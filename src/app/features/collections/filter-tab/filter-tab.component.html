<!-- Sidebar Filters -->
<div class="w-full rounded-lg bg-gray-100 p-4 shadow-sm">
  <!-- Mobile Close Button -->
  <div *ngIf="isMobile" class="mb-4 flex justify-end">
    <button (click)="closeSidebar()" class="text-gray-500 hover:text-gray-700">
      <i class="ri-close-line text-xl"></i>
    </button>
  </div>

  <!-- Active Filters -->
  <div class="mb-6">
    <div class="mb-4 flex items-center justify-between">
      <h3 class="font-medium text-gray-800">Filters</h3>
      <button
        *ngIf="activeFilters.length > 0"
        (click)="clearAllFilters()"
        class="text-sm text-hover-color hover:text-hover-color"
      >
        Clear All
      </button>
    </div>

    <div class="flex flex-wrap gap-2">
      <div
        *ngFor="let filter of activeFilters"
        class="flex items-center bg-gray-200 px-3 py-1 text-sm"
      >
        <span>{{ filter }}</span>
        <button
          (click)="removeFilter(filter)"
          class="ml-2 text-gray-500 hover:text-gray-700"
        >
          <i class="ri-close-line"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Categories -->
  <div class="border-t pb-2 pt-4">
    <div
      class="mb-4 flex cursor-pointer items-center justify-between"
      (click)="toggleFilter('categories')"
    >
      <h3 class="font-medium text-gray-800">Categories</h3>
      <i
        [class]="showCategories ? 'ri-arrow-up-s-line' : 'ri-arrow-down-s-line'"
      ></i>
    </div>

    <div *ngIf="showCategories">
      <div class="relative mb-4">
        <input
          type="text"
          placeholder="Search"
          class="w-full rounded-md border bg-white px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-hover-color"
        />
        <i
          class="ri-search-line absolute right-3 top-1/2 -translate-y-1/2 transform text-gray-400"
        ></i>
      </div>

      <!-- Loading Indicator -->
      <div *ngIf="categoriesLoading" class="flex justify-center py-4">
        <div
          class="h-6 w-6 animate-spin rounded-full border-2 border-t-2 border-hover-color"
        ></div>
      </div>

      <!-- Empty Categories -->
      <div
        *ngIf="!categoriesLoading && categories.length === 0"
        class="py-4 text-center text-gray-500"
      >
        No categories available
      </div>

      <div
        class="space-y-3"
        *ngIf="!categoriesLoading && categories.length > 0"
      >
        <!-- Parent categories and subcategories -->
        <div *ngFor="let category of categories" class="category-item">
          <div
            class="flex cursor-pointer items-center"
            (click)="toggleCategory(category)"
          >
            <!-- Checkbox -->
            <div
              class="mr-2 flex h-4 w-4 items-center justify-center rounded border"
              [ngClass]="{
                'border-hover-color bg-hover-color': category.selected,
                'border-gray-300': !category.selected,
              }"
            >
              <i
                *ngIf="category.selected"
                class="ri-check-line text-xs text-white"
              ></i>
            </div>

            <!-- Category name -->
            <span [ngClass]="{ 'text-hover-color': category.selected }">
              {{ category.name }}
            </span>
          </div>

          <!-- Subcategories (indented) - always displayed -->
          <div
            *ngIf="
              category.isParent &&
              category.subcategories &&
              category.subcategories.length > 0
            "
            class="ml-6 mt-2 space-y-2"
          >
            <div
              *ngFor="let subcategory of category.subcategories"
              class="category-item"
            >
              <div
                class="flex cursor-pointer items-center"
                (click)="toggleCategory(subcategory)"
              >
                <!-- Subcategory checkbox -->
                <div
                  class="mr-2 flex h-4 w-4 items-center justify-center rounded border"
                  [ngClass]="{
                    'border-hover-color bg-hover-color': subcategory.selected,
                    'border-gray-300': !subcategory.selected,
                  }"
                >
                  <i
                    *ngIf="subcategory.selected"
                    class="ri-check-line text-xs text-white"
                  ></i>
                </div>

                <!-- Subcategory name -->
                <span [ngClass]="{ 'text-hover-color': subcategory.selected }">
                  {{ subcategory.name }}
                </span>
              </div>

              <!-- Sub-subcategories (double indented) -->
              <div
                *ngIf="
                  subcategory.isParent &&
                  subcategory.subcategories &&
                  subcategory.subcategories.length > 0
                "
                class="ml-6 mt-2 space-y-2"
              >
                <div
                  *ngFor="let subSubcategory of subcategory.subcategories"
                  class="flex cursor-pointer items-center"
                  (click)="toggleCategory(subSubcategory)"
                >
                  <!-- Sub-subcategory checkbox -->
                  <div
                    class="mr-2 flex h-4 w-4 items-center justify-center rounded border"
                    [ngClass]="{
                      'border-hover-color bg-hover-color':
                        subSubcategory.selected,
                      'border-gray-300': !subSubcategory.selected,
                    }"
                  >
                    <i
                      *ngIf="subSubcategory.selected"
                      class="ri-check-line text-xs text-white"
                    ></i>
                  </div>

                  <!-- Sub-subcategory name -->
                  <span
                    [ngClass]="{ 'text-hover-color': subSubcategory.selected }"
                  >
                    {{ subSubcategory.name }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Brand -->
  <div class="border-t pb-2 pt-4">
    <div
      class="mb-4 flex cursor-pointer items-center justify-between"
      (click)="toggleFilter('brands')"
    >
      <h3 class="font-medium text-gray-800">Brand</h3>
      <i
        [class]="showBrands ? 'ri-arrow-up-s-line' : 'ri-arrow-down-s-line'"
      ></i>
    </div>

    <div *ngIf="showBrands">
      <div class="relative mb-4">
        <input
          type="text"
          placeholder="Search"
          class="w-full rounded-md border bg-white px-3 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-offset-hover-color"
        />
        <i
          class="ri-search-line absolute right-3 top-1/2 -translate-y-1/2 transform text-gray-400"
        ></i>
      </div>

      <div class="space-y-3">
        <div
          *ngFor="let brand of brands"
          class="flex cursor-pointer items-center"
        >
          <div class="mr-2 h-4 w-4 rounded border border-gray-300"></div>
          <span>{{ brand.name }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Colour -->
  <div class="border-t pb-2 pt-4">
    <div
      class="mb-4 flex cursor-pointer items-center justify-between"
      (click)="toggleFilter('colors')"
    >
      <h3 class="font-medium text-gray-800">Colour</h3>
      <i
        [class]="showColors ? 'ri-arrow-up-s-line' : 'ri-arrow-down-s-line'"
      ></i>
    </div>

    <div *ngIf="showColors">
      <div class="space-y-3">
        <div
          *ngFor="let color of colors"
          class="flex cursor-pointer items-center"
        >
          <div class="mr-2 h-4 w-4 rounded border border-gray-300"></div>
          <span>{{ color.name }}</span>
        </div>
      </div>
    </div>
  </div>
</div>
