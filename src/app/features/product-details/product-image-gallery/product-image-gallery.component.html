<!-- Show loading indicator while images are being prepared -->
<div *ngIf="loadingImages" class="flex h-64 items-center justify-center">
  <div
    class="h-12 w-12 animate-spin rounded-full border-b-2 border-gray-900"
  ></div>
</div>

<!-- Show gallery when images are loaded -->
<div
  *ngIf="!loadingImages && images.length > 0"
  id="product-gallery"
  [class.sticky-active]="isSticky"
  class="z-0"
>
  <p-galleria
    [value]="images"
    [showItemNavigators]="true"
    [showThumbnailNavigators]="false"
    [responsiveOptions]="responsiveOptions"
    [circular]="true"
    [numVisible]="5"
    [containerStyle]="{ 'max-width': '640px' }"
  >
    <ng-template pTemplate="item" let-item>
      <img [src]="item.itemImageSrc" class="block w-full" [alt]="item.alt" />
    </ng-template>

    <ng-template pTemplate="thumbnail" let-item>
      <img
        [src]="item.thumbnailImageSrc"
        class="block h-auto w-full"
        [alt]="item.alt"
      />
    </ng-template>
  </p-galleria>
</div>

<!-- Fallback in case no images are available -->
<div
  *ngIf="!loadingImages && !imagesLoaded && images.length === 0"
  class="relative flex h-64 items-center justify-center rounded-lg bg-gray-100"
>
  <img
    src="assets/default-image.png"
    alt="Default Product Image"
    class="h-full w-full rounded object-cover"
  />
</div>

<style>
  :host ::ng-deep .p-galleria-prev-button,
  :host ::ng-deep .p-galleria-next-button {
    background-color: gray;
  }

  :host ::ng-deep .p-galleria-prev-button:hover,
  :host ::ng-deep .p-galleria-next-button:hover {
    background-color: darkgray !important;
  }

  :host ::ng-deep .p-galleria-thumbnails-content {
    background: darkgray;
  }

  @media (min-width: 1024px) {
    .sticky-active {
      position: sticky;
      top: 1rem;
      z-index: 100;
      transition:
        top 0.3s ease-in-out,
        z-index 0s 0.3s;
    }
  }

  :host ::ng-deep .sticky .p-galleria {
    position: sticky;
    top: 0;
    z-index: 100;
    background-color: white;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }
</style>
